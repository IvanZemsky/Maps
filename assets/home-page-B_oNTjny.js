const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-QKxVEzdV.js","assets/index-Cy_VaaiA.css"])))=>i.map(i=>d[i]);
import{d as h,c as C,o as f,a as se,u as ue,r as g,b as j,e as N,n as ke,f as m,w as L,g as v,h as K,t as Ze,_ as oe,i as Z,j as He,v as qe,k as G,F as $,m as T,s as We,p as de,q as te,x as X,y as Je,z as E,A as B,B as O,C as D,D as I,E as ve,G as ye,H as ge,I as Xe,J as Ye,K as Qe,L as et,M as tt,N as fe,O as ot,P as nt}from"./index-QKxVEzdV.js";const lt={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 1024 1024"},at=h({name:"CloseOutlined",render:function(e,t){return f(),C("svg",lt,t[0]||(t[0]=[se("path",{d:"M563.8 512l262.5-312.9c4.4-5.2.7-13.1-6.1-13.1h-79.8c-4.7 0-9.2 2.1-12.3 5.7L511.6 449.8L295.1 191.7c-3-3.6-7.5-5.7-12.3-5.7H203c-6.8 0-10.5 7.9-6.1 13.1L459.4 512L196.9 824.9A7.95 7.95 0 0 0 203 838h79.8c4.7 0 9.2-2.1 12.3-5.7l216.5-258.1l216.5 258.1c3 3.6 7.5 5.7 12.3 5.7h79.8c6.8 0 10.5-7.9 6.1-13.1L563.8 512z",fill:"currentColor"},null,-1)]))}}),rt=h({__name:"key-card-polygon",props:{keyId:{},polygon:{},number:{}},setup(o){const e=ue(),t=g(o.polygon.value);function n(){e.removePolygon(o.polygon.value.id)}function r(){e.startDrawing(o.keyId,o.polygon.value.id)}return(a,l)=>{var d;const s=j("ui-button"),i=j("ui-input"),p=j("ui-spacing");return f(),N(p,{class:ke(["polygon-card",{active:((d=m(e).drawingPolygon)==null?void 0:d.id)===a.polygon.value.id}]),align:"center",gap:"sm"},{default:L(()=>{var u;return[v(s,{disabled:((u=m(e).drawingPolygon)==null?void 0:u.id)===a.polygon.value.id,onClick:r,class:"key-draw-control-btn",size:"sm",variant:"outlined"},{default:L(()=>[K(" Draw #"+Ze(a.number),1)]),_:1},8,["disabled"]),v(i,{class:"polygon-weight-input",size:"sm",modelValue:t.value.weight,"onUpdate:modelValue":l[0]||(l[0]=b=>t.value.weight=b),modelModifiers:{number:!0},type:"number",min:"0",max:"5"},null,8,["modelValue"]),v(s,{class:"key-draw-control-btn remove-polygon-btn",size:"sm",variant:"outlined",onClick:n},{default:L(()=>[v(m(at))]),_:1})]}),_:1},8,["class"])}}}),st=oe(rt,[["__scopeId","data-v-30123071"]]),it=h({__name:"key-card",props:{id:{},number:{}},setup(o){const e=ue(),t=Z(()=>e.findKeyById(o.id));function n(){e.removeKey(t.value.id)}function r(){e.createPolygon(o.id)}return(a,l)=>{const s=j("ui-input"),i=j("ui-button"),p=j("ui-spacing"),d=j("ui-card");return f(),N(d,{class:"key-card",size:"sm"},{default:L(()=>[v(p,{vertical:"",gap:"sm",align:"stretch"},{default:L(()=>[v(s,{placeholder:`Key #${a.number}`,size:"sm",modelValue:t.value.name,"onUpdate:modelValue":l[0]||(l[0]=u=>t.value.name=u),modelModifiers:{trim:!0}},null,8,["placeholder","modelValue"]),He(se("input",{class:"color-input",type:"color","onUpdate:modelValue":l[1]||(l[1]=u=>t.value.color=u)},null,512),[[qe,t.value.color,void 0,{lazy:!0}]]),(f(!0),C($,null,G(t.value.polygons,(u,b)=>(f(),N(st,{key:u.id,keyId:a.id,polygon:g(u),number:b+1},null,8,["keyId","polygon","number"]))),128)),v(i,{size:"sm",onClick:r},{default:L(()=>l[2]||(l[2]=[K("Add polygon")])),_:1,__:[2]}),v(i,{size:"sm",onClick:n},{default:L(()=>l[3]||(l[3]=[K("Remove")])),_:1,__:[3]})]),_:1})]),_:1})}}}),ut=oe(it,[["__scopeId","data-v-5228b1bd"]]),dt={class:"scroll-area"},pt={class:"draw-btn-wrap"},ct=h({__name:"new-region-controls",setup(o){const e=T("mapCenter"),t=ue(),{region:n}=We(t);function r(){e!=null&&e.value&&t.setMapCenter(e.value)}return(a,l)=>{const s=j("ui-input"),i=j("ui-button"),p=j("ui-spacing"),d=j("ui-wrapper");return m(t).isDrawing?(f(),N(d,{key:0,class:"controls",onClick:l[1]||(l[1]=te(()=>{},["stop"])),onMousedown:l[2]||(l[2]=te(()=>{},["stop"])),onMouseup:l[3]||(l[3]=te(()=>{},["stop"])),onMousemove:l[4]||(l[4]=te(()=>{},["stop"])),onWheel:l[5]||(l[5]=te(()=>{},["stop"])),paddings:"both"},{default:L(()=>[se("div",dt,[v(p,{class:"content",vertical:"",fill:"",align:"stretch",gap:"sm"},{default:L(()=>[v(s,{placeholder:"Region name",size:"sm",class:"region-name-input",modelValue:m(n).name,"onUpdate:modelValue":l[0]||(l[0]=u=>m(n).name=u)},null,8,["modelValue"]),v(i,{size:"sm",onClick:m(t).saveRegionToFile},{default:L(()=>l[6]||(l[6]=[K(" Save region ")])),_:1,__:[6]},8,["onClick"]),v(i,{onClick:r,class:"key-draw-control-btn",size:"sm",variant:"outlined"},{default:L(()=>l[7]||(l[7]=[K(" Set map center ")])),_:1,__:[7]}),se("div",pt,[v(i,{disabled:!m(t).drawingPolygon,onClick:m(t).stopDrawing,class:"key-draw-control-btn",size:"sm",variant:"outlined"},{default:L(()=>l[8]||(l[8]=[K(" Stop drawing ")])),_:1,__:[8]},8,["disabled","onClick"])]),(f(!0),C($,null,G(m(t).region.keys,(u,b)=>(f(),N(ut,{id:u.id,key:u.id,number:b+1},null,8,["id","number"]))),128)),v(i,{size:"sm",onClick:m(t).createKey},{default:L(()=>l[9]||(l[9]=[K("Add key")])),_:1,__:[9]},8,["onClick"])]),_:1})])]),_:1})):de("",!0)}}}),mt=oe(ct,[["__scopeId","data-v-66945ecb"]]),Pe=(o,e)=>{for(const t of Object.keys(e))o.on(t,e[t])},je=o=>{for(const e of Object.keys(o)){const t=o[e];t&&F(t.cancel)&&t.cancel()}},yt=o=>!o||typeof o.charAt!="function"?o:o.charAt(0).toUpperCase()+o.slice(1),F=o=>typeof o=="function",z=(o,e,t)=>{for(const n in t){const r="set"+yt(n);o[r]?ye(()=>t[n],(a,l)=>{o[r](a,l)}):e[r]&&ye(()=>t[n],a=>{e[r](a)})}},A=(o,e,t={})=>{const n={...t};for(const r in o){const a=e[r],l=o[r];a&&(a&&a.custom===!0||l!==void 0&&(n[r]=l))}return n},H=o=>{const e={},t={};for(const n in o)if(n.startsWith("on")&&!n.startsWith("onUpdate")&&n!=="onReady"){const r=n.slice(2).toLocaleLowerCase();e[r]=o[n]}else t[n]=o[n];return{listeners:e,attrs:t}},ft=async o=>{const e=await Promise.all([O(()=>import("./marker-icon-2x-D4k_ikNW.js"),[]),O(()=>import("./marker-icon-C2eJqgqv.js"),[]),O(()=>import("./marker-shadow-DU6CIJ0p.js"),[])]);delete o.Default.prototype._getIconUrl,o.Default.mergeOptions({iconRetinaUrl:e[0].default,iconUrl:e[1].default,shadowUrl:e[2].default})},ae=o=>{const e=g((...n)=>console.warn(`Method ${o} has been invoked without being replaced`)),t=(...n)=>e.value(...n);return t.wrapped=e,E(o,t),t},re=(o,e)=>o.wrapped.value=e,R=typeof self=="object"&&self.self===self&&self||typeof global=="object"&&global.global===global&&global||globalThis,P=o=>{const e=T(o);if(e===void 0)throw new Error(`Attempt to inject ${o.description} before it was provided.`);return e},M=Symbol("useGlobalLeaflet"),q=Symbol("addLayer"),be=Symbol("removeLayer"),ne=Symbol("registerControl"),vt=Symbol("registerLayerControl"),Ie=Symbol("canSetParentHtml"),Be=Symbol("setParentHtml"),Ee=Symbol("setIcon"),gt=Symbol("bindPopup"),bt=Symbol("bindTooltip"),_t=Symbol("unbindPopup"),ht=Symbol("unbindTooltip"),le={options:{type:Object,default:()=>({}),custom:!0}},pe=o=>({options:o.options,methods:{}}),Y={...le,pane:{type:String},attribution:{type:String},name:{type:String,custom:!0},layerType:{type:String,custom:!0},visible:{type:Boolean,custom:!0,default:!0}},_e=(o,e,t)=>{const n=P(q),r=P(be),{options:a,methods:l}=pe(o),s=A(o,Y,a),i=()=>n({leafletObject:e.value}),p=()=>r({leafletObject:e.value}),d={...l,setAttribution(u){p(),e.value.options.attribution=u,o.visible&&i()},setName(){p(),o.visible&&i()},setLayerType(){p(),o.visible&&i()},setVisible(u){e.value&&(u?i():p())},bindPopup(u){if(!e.value||!F(e.value.bindPopup)){console.warn("Attempt to bind popup before bindPopup method available on layer.");return}e.value.bindPopup(u)},bindTooltip(u){if(!e.value||!F(e.value.bindTooltip)){console.warn("Attempt to bind tooltip before bindTooltip method available on layer.");return}e.value.bindTooltip(u)},unbindTooltip(){e.value&&(F(e.value.closeTooltip)&&e.value.closeTooltip(),F(e.value.unbindTooltip)&&e.value.unbindTooltip())},unbindPopup(){e.value&&(F(e.value.closePopup)&&e.value.closePopup(),F(e.value.unbindPopup)&&e.value.unbindPopup())},updateVisibleProp(u){t.emit("update:visible",u)}};return E(gt,d.bindPopup),E(bt,d.bindTooltip),E(_t,d.unbindPopup),E(ht,d.unbindTooltip),ge(()=>{d.unbindPopup(),d.unbindTooltip(),p()}),{options:s,methods:d}},he=(o,e)=>{if(o&&e.default)return X("div",{style:{display:"none"}},e.default())},ze={...Y,interactive:{type:Boolean,default:void 0},bubblingMouseEvents:{type:Boolean,default:void 0}},wt=(o,e,t)=>{const{options:n,methods:r}=_e(o,e,t);return{options:A(o,ze,n),methods:r}},we={...ze,stroke:{type:Boolean,default:void 0},color:{type:String},weight:{type:Number},opacity:{type:Number},lineCap:{type:String},lineJoin:{type:String},dashArray:{type:String},dashOffset:{type:String},fill:{type:Boolean,default:void 0},fillColor:{type:String},fillOpacity:{type:Number},fillRule:{type:String},className:{type:String}},Lt=(o,e,t)=>{const{options:n,methods:r}=wt(o,e,t),a=A(o,we,n),l=P(be),s={...r,setStroke(i){e.value.setStyle({stroke:i})},setColor(i){e.value.setStyle({color:i})},setWeight(i){e.value.setStyle({weight:i})},setOpacity(i){e.value.setStyle({opacity:i})},setLineCap(i){e.value.setStyle({lineCap:i})},setLineJoin(i){e.value.setStyle({lineJoin:i})},setDashArray(i){e.value.setStyle({dashArray:i})},setDashOffset(i){e.value.setStyle({dashOffset:i})},setFill(i){e.value.setStyle({fill:i})},setFillColor(i){e.value.setStyle({fillColor:i})},setFillOpacity(i){e.value.setStyle({fillOpacity:i})},setFillRule(i){e.value.setStyle({fillRule:i})},setClassName(i){e.value.setStyle({className:i})}};return ve(()=>{l({leafletObject:e.value})}),{options:a,methods:s}},Ct={...we,radius:{type:Number},latLng:{type:[Object,Array],required:!0,custom:!0}};({...Ct});const Q={...le,position:{type:String}},ce=(o,e)=>{const{options:t,methods:n}=pe(o),r=A(o,Q,t),a={...n,setPosition(l){e.value&&e.value.setPosition(l)}};return ge(()=>{e.value&&e.value.remove()}),{options:r,methods:a}},St=o=>o.default?X("div",{ref:"root"},o.default()):null;h({name:"LControl",props:{...Q,disableClickPropagation:{type:Boolean,custom:!0,default:!0},disableScrollPropagation:{type:Boolean,custom:!0,default:!1}},setup(o,e){const t=g(),n=g(),r=T(M),a=P(ne),{options:l,methods:s}=ce(o,t);return B(async()=>{const{Control:i,DomEvent:p}=r?R.L:await O(()=>import("./leaflet-src.esm-HdBnhJze.js"),[]),d=i.extend({onAdd(){return n.value}});t.value=D(new d(l)),z(s,t.value,o),a({leafletObject:t.value}),o.disableClickPropagation&&n.value&&p.disableClickPropagation(n.value),o.disableScrollPropagation&&n.value&&p.disableScrollPropagation(n.value),I(()=>e.emit("ready",t.value))}),{root:n,leafletObject:t}},render(){return St(this.$slots)}});const Me={...Q,prefix:{type:String}},Ot=(o,e)=>{const{options:t,methods:n}=ce(o,e),r=A(o,Me,t),a={...n,setPrefix(l){e.value.setPrefix(l)}};return{options:r,methods:a}},Pt=h({name:"LControlAttribution",props:Me,setup(o,e){const t=g(),n=T(M),r=P(ne),{options:a,methods:l}=Ot(o,t);return B(async()=>{const{control:s}=n?R.L:await O(()=>import("./leaflet-src.esm-HdBnhJze.js"),[]);t.value=D(s.attribution(a)),z(l,t.value,o),r({leafletObject:t.value}),I(()=>e.emit("ready",t.value))}),{leafletObject:t}},render(){return null}});({...Q});const Ne={...Q,maxWidth:{type:Number},metric:{type:Boolean,default:void 0},imperial:{type:Boolean,default:void 0},updateWhenIdle:{type:Boolean,default:void 0}},Tt=(o,e)=>{const{options:t,methods:n}=ce(o,e);return{options:A(o,Ne,t),methods:n}},At=h({name:"LControlScale",props:Ne,setup(o,e){const t=g(),n=T(M),r=P(ne),{options:a,methods:l}=Tt(o,t);return B(async()=>{const{control:s}=n?R.L:await O(()=>import("./leaflet-src.esm-HdBnhJze.js"),[]);t.value=D(s.scale(a)),z(l,t.value,o),r({leafletObject:t.value}),I(()=>e.emit("ready",t.value))}),{leafletObject:t}},render(){return null}}),De={...Q,zoomInText:{type:String},zoomInTitle:{type:String},zoomOutText:{type:String},zoomOutTitle:{type:String}},Rt=(o,e)=>{const{options:t,methods:n}=ce(o,e);return{options:A(o,De,t),methods:n}},kt=h({name:"LControlZoom",props:De,setup(o,e){const t=g(),n=T(M),r=P(ne),{options:a,methods:l}=Rt(o,t);return B(async()=>{const{control:s}=n?R.L:await O(()=>import("./leaflet-src.esm-HdBnhJze.js"),[]);t.value=D(s.zoom(a)),z(l,t.value,o),r({leafletObject:t.value}),I(()=>e.emit("ready",t.value))}),{leafletObject:t}},render(){return null}}),xe={...Y};({...xe});({...xe});const Le={...Y,opacity:{type:Number},zIndex:{type:Number},tileSize:{type:[Number,Array,Object]},noWrap:{type:Boolean,default:void 0},minZoom:{type:Number},maxZoom:{type:Number},className:{type:String}},Ve=(o,e,t)=>{const{options:n,methods:r}=_e(o,e,t),a=A(o,Le,n),l={...r,setTileComponent(){var s;(s=e.value)==null||s.redraw()}};return ge(()=>{e.value.off()}),{options:a,methods:l}},jt=(o,e,t,n)=>o.extend({initialize(r){this.tileComponents={},this.on("tileunload",this._unloadTile),t.setOptions(this,r)},createTile(r){const a=this._tileCoordsToKey(r);this.tileComponents[a]=e.create("div");const l=X({setup:n,props:["coords"]},{coords:r});return Xe(l,this.tileComponents[a]),this.tileComponents[a]},_unloadTile(r){const a=this._tileCoordsToKey(r.coords);this.tileComponents[a]&&(this.tileComponents[a].innerHTML="",this.tileComponents[a]=void 0)}});h({props:{...Le,childRender:{type:Function,required:!0}},setup(o,e){const t=g(),n=g(null),r=g(!1),a=T(M),l=P(q),{options:s,methods:i}=Ve(o,t,e);return B(async()=>{const{GridLayer:p,DomUtil:d,Util:u}=a?R.L:await O(()=>import("./leaflet-src.esm-HdBnhJze.js"),[]),b=jt(p,d,u,o.childRender);t.value=D(new b(s));const{listeners:y}=H(e.attrs);t.value.on(y),z(i,t.value,o),l({...o,...i,leafletObject:t.value}),r.value=!0,I(()=>e.emit("ready",t.value))}),{root:n,ready:r,leafletObject:t}},render(){return this.ready?X("div",{style:{display:"none"},ref:"root"}):null}});const Te={iconUrl:{type:String},iconRetinaUrl:{type:String},iconSize:{type:[Object,Array]},iconAnchor:{type:[Object,Array]},popupAnchor:{type:[Object,Array]},tooltipAnchor:{type:[Object,Array]},shadowUrl:{type:String},shadowRetinaUrl:{type:String},shadowSize:{type:[Object,Array]},shadowAnchor:{type:[Object,Array]},bgPos:{type:[Object,Array]},className:{type:String}};h({name:"LIcon",props:{...Te,...le},setup(o,e){const t=g(),n=T(M),r=P(Ie),a=P(Be),l=P(Ee);let s,i,p,d,u;const b=(V,w,S)=>{const k=V&&V.innerHTML;if(!w){S&&u&&r()&&a(k);return}const{listeners:J}=H(e.attrs);u&&i(u,J);const{options:me}=pe(o),U=A(o,Te,me);k&&(U.html=k),u=U.html?p(U):d(U),s(u,J),l(u)},y=()=>{I(()=>b(t.value,!0,!1))},x=()=>{I(()=>b(t.value,!1,!0))},W={setIconUrl:y,setIconRetinaUrl:y,setIconSize:y,setIconAnchor:y,setPopupAnchor:y,setTooltipAnchor:y,setShadowUrl:y,setShadowRetinaUrl:y,setShadowAnchor:y,setBgPos:y,setClassName:y,setHtml:y};return B(async()=>{const{DomEvent:V,divIcon:w,icon:S}=n?R.L:await O(()=>import("./leaflet-src.esm-HdBnhJze.js"),[]);s=V.on,i=V.off,p=w,d=S,z(W,{},o),new MutationObserver(x).observe(t.value,{attributes:!0,childList:!0,characterData:!0,subtree:!0}),y()}),{root:t}},render(){const o=this.$slots.default?this.$slots.default():void 0;return X("div",{ref:"root"},o)}});({...Y});function Ue(o,e,t){var n,r,a;e===void 0&&(e=50),t===void 0&&(t={});var l=(n=t.isImmediate)!=null&&n,s=(r=t.callback)!=null&&r,i=t.maxWait,p=Date.now(),d=[];function u(){if(i!==void 0){var y=Date.now()-p;if(y+e>=i)return i-y}return e}var b=function(){var y=[].slice.call(arguments),x=this;return new Promise(function(W,V){var w=l&&a===void 0;if(a!==void 0&&clearTimeout(a),a=setTimeout(function(){if(a=void 0,p=Date.now(),!l){var k=o.apply(x,y);s&&s(k),d.forEach(function(J){return(0,J.resolve)(k)}),d=[]}},u()),w){var S=o.apply(x,y);return s&&s(S),W(S)}d.push({resolve:W,reject:V})})};return b.cancel=function(y){a!==void 0&&clearTimeout(a),d.forEach(function(x){return(0,x.reject)(y)}),d=[]},b}const Ae={...le,center:{type:[Object,Array]},bounds:{type:[Array,Object]},maxBounds:{type:[Array,Object]},zoom:{type:Number},minZoom:{type:Number},maxZoom:{type:Number},paddingBottomRight:{type:[Object,Array]},paddingTopLeft:{type:Object},padding:{type:Object},worldCopyJump:{type:Boolean,default:void 0},crs:{type:[String,Object]},maxBoundsViscosity:{type:Number},inertia:{type:Boolean,default:void 0},inertiaDeceleration:{type:Number},inertiaMaxSpeed:{type:Number},easeLinearity:{type:Number},zoomAnimation:{type:Boolean,default:void 0},zoomAnimationThreshold:{type:Number},fadeAnimation:{type:Boolean,default:void 0},markerZoomAnimation:{type:Boolean,default:void 0},noBlockingAnimations:{type:Boolean,default:void 0},useGlobalLeaflet:{type:Boolean,default:!0,custom:!0}},It=h({inheritAttrs:!1,emits:["ready","update:zoom","update:center","update:bounds"],props:Ae,setup(o,e){const t=g(),n=Je({ready:!1,layersToAdd:[],layersInControl:[]}),{options:r}=pe(o),a=A(o,Ae,r),{listeners:l,attrs:s}=H(e.attrs),i=ae(q),p=ae(be),d=ae(ne),u=ae(vt);E(M,o.useGlobalLeaflet);const b=Z(()=>{const w={};return o.noBlockingAnimations&&(w.animate=!1),w}),y=Z(()=>{const w=b.value;return o.padding&&(w.padding=o.padding),o.paddingTopLeft&&(w.paddingTopLeft=o.paddingTopLeft),o.paddingBottomRight&&(w.paddingBottomRight=o.paddingBottomRight),w}),x={moveend:Ue(w=>{n.leafletRef&&(e.emit("update:zoom",n.leafletRef.getZoom()),e.emit("update:center",n.leafletRef.getCenter()),e.emit("update:bounds",n.leafletRef.getBounds()))}),overlayadd(w){const S=n.layersInControl.find(k=>k.name===w.name);S&&S.updateVisibleProp(!0)},overlayremove(w){const S=n.layersInControl.find(k=>k.name===w.name);S&&S.updateVisibleProp(!1)}};B(async()=>{o.useGlobalLeaflet&&(R.L=R.L||await O(()=>import("./index-QKxVEzdV.js").then(c=>c.l),__vite__mapDeps([0,1])));const{map:w,CRS:S,Icon:k,latLngBounds:J,latLng:me,stamp:U}=o.useGlobalLeaflet?R.L:await O(()=>import("./leaflet-src.esm-HdBnhJze.js"),[]);try{a.beforeMapMount&&await a.beforeMapMount()}catch(c){console.error(`The following error occurred running the provided beforeMapMount hook ${c.message}`)}await ft(k);const Ke=typeof a.crs=="string"?S[a.crs]:a.crs;a.crs=Ke||S.EPSG3857;const ee={addLayer(c){c.layerType!==void 0&&(n.layerControl===void 0?n.layersToAdd.push(c):n.layersInControl.find(_=>U(_.leafletObject)===U(c.leafletObject))||(n.layerControl.addLayer(c),n.layersInControl.push(c))),c.visible!==!1&&n.leafletRef.addLayer(c.leafletObject)},removeLayer(c){c.layerType!==void 0&&(n.layerControl===void 0?n.layersToAdd=n.layersToAdd.filter(_=>_.name!==c.name):(n.layerControl.removeLayer(c.leafletObject),n.layersInControl=n.layersInControl.filter(_=>U(_.leafletObject)!==U(c.leafletObject)))),n.leafletRef.removeLayer(c.leafletObject)},registerLayerControl(c){n.layerControl=c,n.layersToAdd.forEach(_=>{n.layerControl.addLayer(_)}),n.layersToAdd=[],d(c)},registerControl(c){n.leafletRef.addControl(c.leafletObject)},setZoom(c){const _=n.leafletRef.getZoom();c!==_&&n.leafletRef.setZoom(c,b.value)},setCrs(c){const _=n.leafletRef.getBounds();n.leafletRef.options.crs=c,n.leafletRef.fitBounds(_,{animate:!1,padding:[0,0]})},fitBounds(c){n.leafletRef.fitBounds(c,y.value)},setBounds(c){if(!c)return;const _=J(c);_.isValid()&&!(n.lastSetBounds||n.leafletRef.getBounds()).equals(_,0)&&(n.lastSetBounds=_,n.leafletRef.fitBounds(_))},setCenter(c){if(c==null)return;const _=me(c),Oe=n.lastSetCenter||n.leafletRef.getCenter();(Oe.lat!==_.lat||Oe.lng!==_.lng)&&(n.lastSetCenter=_,n.leafletRef.panTo(_,b.value))}};re(i,ee.addLayer),re(p,ee.removeLayer),re(d,ee.registerControl),re(u,ee.registerLayerControl),n.leafletRef=D(w(t.value,a)),z(ee,n.leafletRef,o),Pe(n.leafletRef,x),Pe(n.leafletRef,l),n.ready=!0,I(()=>e.emit("ready",n.leafletRef))}),ve(()=>{je(x),n.leafletRef&&(n.leafletRef.off(),n.leafletRef.remove())});const W=Z(()=>n.leafletRef),V=Z(()=>n.ready);return{root:t,ready:V,leafletObject:W,attrs:s}},render({attrs:o}){return o.style||(o.style={}),o.style.width||(o.style.width="100%"),o.style.height||(o.style.height="100%"),X("div",{...o,ref:"root"},this.ready&&this.$slots.default?this.$slots.default():{})}}),Bt=["Symbol(Comment)","Symbol(Text)"],Et=["LTooltip","LPopup"],$e={...Y,draggable:{type:Boolean,default:void 0},icon:{type:[Object]},zIndexOffset:{type:Number},latLng:{type:[Object,Array],custom:!0,required:!0}},zt=(o,e,t)=>{const{options:n,methods:r}=_e(o,e,t),a=A(o,$e,n),l={...r,setDraggable(s){e.value.dragging&&(s?e.value.dragging.enable():e.value.dragging.disable())},latLngSync(s){t.emit("update:latLng",s.latlng),t.emit("update:lat-lng",s.latlng)},setLatLng(s){if(s!=null&&e.value){const i=e.value.getLatLng();(!i||!i.equals(s))&&e.value.setLatLng(s)}}};return{options:a,methods:l}},Mt=(o,e)=>{const t=e.slots.default&&e.slots.default();return t&&t.length&&t.some(Nt)};function Nt(o){return!(Bt.includes(o.type.toString())||Et.includes(o.type.name))}const Dt=h({name:"LMarker",props:$e,setup(o,e){const t=g(),n=g(!1),r=T(M),a=P(q);E(Ie,()=>{var p;return!!((p=t.value)!=null&&p.getElement())}),E(Be,p=>{var d,u;const b=F((d=t.value)==null?void 0:d.getElement)&&((u=t.value)==null?void 0:u.getElement());b&&(b.innerHTML=p)}),E(Ee,p=>{var d;return((d=t.value)==null?void 0:d.setIcon)&&t.value.setIcon(p)});const{options:l,methods:s}=zt(o,t,e),i={moveHandler:Ue(s.latLngSync)};return B(async()=>{const{marker:p,divIcon:d}=r?R.L:await O(()=>import("./leaflet-src.esm-HdBnhJze.js"),[]);Mt(l,e)&&(l.icon=d({className:""})),t.value=D(p(o.latLng,l));const{listeners:u}=H(e.attrs);t.value.on(u),t.value.on("move",i.moveHandler),z(s,t.value,o),a({...o,...s,leafletObject:t.value}),n.value=!0,I(()=>e.emit("ready",t.value))}),ve(()=>je(i)),{ready:n,leafletObject:t}},render(){return he(this.ready,this.$slots)}}),Ce={...we,smoothFactor:{type:Number},noClip:{type:Boolean,default:void 0},latLngs:{type:Array,required:!0,custom:!0}},Fe=(o,e,t)=>{const{options:n,methods:r}=Lt(o,e,t),a=A(o,Ce,n),l={...r,setSmoothFactor(s){e.value.setStyle({smoothFactor:s})},setNoClip(s){e.value.setStyle({noClip:s})},addLatLng(s){e.value.addLatLng(s)}};return{options:a,methods:l}},ie={...Ce},xt=(o,e,t)=>{const{options:n,methods:r}=Fe(o,e,t),a=A(o,ie,n),l={...r,toGeoJSON(s){return e.value.toGeoJSON(s)}};return{options:a,methods:l}},Vt=h({name:"LPolygon",props:ie,setup(o,e){const t=g(),n=g(!1),r=T(M),a=P(q),{options:l,methods:s}=xt(o,t,e);return B(async()=>{const{polygon:i}=r?R.L:await O(()=>import("./leaflet-src.esm-HdBnhJze.js"),[]);t.value=D(i(o.latLngs,l));const{listeners:p}=H(e.attrs);t.value.on(p),z(s,t.value,o),a({...o,...s,leafletObject:t.value}),n.value=!0,I(()=>e.emit("ready",t.value))}),{ready:n,leafletObject:t}},render(){return he(this.ready,this.$slots)}}),Ut=h({name:"LPolyline",props:Ce,setup(o,e){const t=g(),n=g(!1),r=T(M),a=P(q),{options:l,methods:s}=Fe(o,t,e);return B(async()=>{const{polyline:i}=r?R.L:await O(()=>import("./leaflet-src.esm-HdBnhJze.js"),[]);t.value=D(i(o.latLngs,l));const{listeners:p}=H(e.attrs);t.value.on(p),z(s,t.value,o),a({...o,...s,leafletObject:t.value}),n.value=!0,I(()=>e.emit("ready",t.value))}),{ready:n,leafletObject:t}},render(){return he(this.ready,this.$slots)}}),Ge={...le,content:{type:String,default:null}};({...Ge});({...ie,latLngs:{...ie.latLngs}});const Se={...Le,tms:{type:Boolean,default:void 0},subdomains:{type:[String,Array],validator:o=>typeof o=="string"?!0:Array.isArray(o)?o.every(e=>typeof e=="string"):!1},detectRetina:{type:Boolean,default:void 0},url:{type:String,required:!0,custom:!0}},$t=(o,e,t)=>{const{options:n,methods:r}=Ve(o,e,t),a=A(o,Se,n),l={...r};return{options:a,methods:l}},Ft=h({props:Se,setup(o,e){const t=g(),n=T(M),r=P(q),{options:a,methods:l}=$t(o,t,e);return B(async()=>{const{tileLayer:s}=n?R.L:await O(()=>import("./leaflet-src.esm-HdBnhJze.js"),[]);t.value=D(s(o.url,a));const{listeners:i}=H(e.attrs);t.value.on(i),z(l,t.value,o),r({...o,...l,leafletObject:t.value}),I(()=>e.emit("ready",t.value))}),{leafletObject:t}},render(){return null}});({...Ge});({...Se});const Gt=h({__name:"map-polylines",props:{drawingPolygonId:{}},setup(o){const e=o,t=T("region");function n(r){return e.drawingPolygonId===r}if(!(t!=null&&t.value))throw new Error("Map region is not provided");return(r,a)=>(f(!0),C($,null,G(m(t).keys,l=>(f(),C("div",{key:l.id},[(f(!0),C($,null,G(l.polygons,s=>(f(),C("div",{key:s.id},[n(s.id)?(f(),N(m(Ut),{key:0,id:s.id,"lat-lngs":s.latlngs,color:l.color,weight:1},null,8,["id","lat-lngs","color"])):de("",!0)]))),128))]))),128))}}),Kt=h({__name:"map-polygons",props:{drawingPolygonId:{}},setup(o){const e=o,t=T("region");function n(r){return e.drawingPolygonId!==r}if(!(t!=null&&t.value))throw new Error("Map region is not provided");return(r,a)=>(f(!0),C($,null,G(m(t).keys,l=>(f(),C("div",{key:l.id},[(f(!0),C($,null,G(l.polygons,s=>(f(),C("div",{key:s.id},[n(s.id)?(f(),N(m(Vt),{key:0,id:s.id,"lat-lngs":s.latlngs,color:l.color,weight:s.weight},null,8,["id","lat-lngs","color","weight"])):de("",!0)]))),128))]))),128))}}),Zt=h({__name:"map-markers",setup(o){const e=T("region");if(!(e!=null&&e.value))throw new Error("Map region is not provided");return(t,n)=>(f(!0),C($,null,G(m(e).keys,r=>(f(),C("div",{key:r.id},[(f(!0),C($,null,G(r.markers,a=>(f(),C("div",{key:a.id},[v(m(Dt),{id:a.id,"lat-lng":a.latlngs,icon:m(Ye)(a.type)},null,8,["id","lat-lng","icon"])]))),128))]))),128))}}),Ht=h({__name:"map-controls",setup(o){return(e,t)=>(f(),C($,null,[v(m(At),{position:"bottomright",imperial:!0,metric:!1}),v(m(kt),{position:"bottomleft"}),v(m(Pt),{prefix:"",position:"topright"})],64))}}),Re={zoom:4,tile:{name:"OpenStreetMap",url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:'&copy; <a target="_blank" href="http://osm.org/copyright">OpenStreetMap</a> contributors'}},qt=h({__name:"map-main",props:{region:{},regionModifiers:{}},emits:Qe(["click"],["update:region"]),setup(o,{emit:e}){var p;const t=g(Re.zoom),n=et("map"),r=e,a=tt(o,"region");E("region",a);const l=g(fe),s=g(((p=a.value)==null?void 0:p.center)||fe);ye(a,d=>{var u;(u=n==null?void 0:n.value)!=null&&u.leafletObject&&n.value.leafletObject.setView(d==null?void 0:d.center),console.log(a)});function i(){var d;if((d=n==null?void 0:n.value)!=null&&d.leafletObject){const u=n.value.leafletObject.getCenter();l.value=[u.lat,u.lng]}}return(d,u)=>{const b=j("ui-spacing");return f(),N(b,{class:"map-wrap",vertical:"",fill:"",grow:""},{default:L(()=>[v(b,{class:"content",fill:"",grow:"",gap:"none"},{default:L(()=>[a.value?(f(),N(m(It),{key:0,ref:"map",zoom:t.value,"onUpdate:zoom":u[0]||(u[0]=y=>t.value=y),center:s.value,"onUpdate:center":u[1]||(u[1]=y=>s.value=y),useGlobalLeaflet:!1,options:{attributionControl:!1,zoomControl:!1},onClick:u[2]||(u[2]=y=>r("click",y)),onMoveend:i},{default:L(()=>[v(m(Ft),nt({"layer-type":"base"},m(Re).tile),null,16),ot(d.$slots,"default",{},void 0,!0)]),_:3},8,["zoom","center"])):de("",!0)]),_:3})]),_:3})}}}),Wt=oe(qt,[["__scopeId","data-v-70f498a0"]]),Jt=h({__name:"home-page",setup(o){const e=ue(),t=Z(()=>e.region),n=Z(()=>e.drawingPolygon!==null),r=g();return E("mapCenter",r),B(()=>{r.value=e.region.center||fe}),(a,l)=>(f(),N(m(Wt),{class:ke({"cursor-pointer":n.value}),onClick:m(e).handleDraw,region:t.value,"onUpdate:region":l[0]||(l[0]=s=>t.value=s)},{default:L(()=>{var s,i;return[v(m(mt)),v(m(Ht)),v(m(Gt),{"drawing-polygon-id":(s=m(e).drawingPolygon)==null?void 0:s.id},null,8,["drawing-polygon-id"]),v(m(Kt),{"drawing-polygon-id":(i=m(e).drawingPolygon)==null?void 0:i.id},null,8,["drawing-polygon-id"]),v(m(Zt))]}),_:1},8,["class","onClick","region"]))}}),Yt=oe(Jt,[["__scopeId","data-v-a9d2acf7"]]);export{Yt as default};
